{"ast":null,"code":"import axios from 'axios';\nimport { toast } from 'react-toastify';\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '/api';\nconst api = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 10000,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Request interceptor to add auth token\napi.interceptors.request.use(config => {\n  if (typeof window !== 'undefined') {\n    const token = localStorage.getItem('token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor for error handling\napi.interceptors.response.use(response => {\n  // Check for new token in response headers (token refresh)\n  const newToken = response.headers['x-new-token'];\n  if (newToken && typeof window !== 'undefined') {\n    localStorage.setItem('token', newToken);\n  }\n  return response;\n}, error => {\n  const {\n    response\n  } = error;\n  if (response) {\n    const {\n      status,\n      data\n    } = response;\n    switch (status) {\n      case 401:\n        // Unauthorized - clear token and redirect to login\n        if (typeof window !== 'undefined') {\n          localStorage.removeItem('token');\n          if (window.location.pathname !== '/login') {\n            window.location.href = '/login';\n          }\n        }\n        break;\n      case 403:\n        toast.error('Access forbidden - insufficient permissions');\n        break;\n      case 404:\n        toast.error('Resource not found');\n        break;\n      case 422:\n        // Validation errors\n        if (data.details && Array.isArray(data.details)) {\n          data.details.forEach(error => {\n            toast.error(`${error.param}: ${error.msg}`);\n          });\n        } else {\n          toast.error(data.error || 'Validation failed');\n        }\n        break;\n      case 429:\n        toast.error('Too many requests - please slow down');\n        break;\n      case 500:\n        toast.error('Server error - please try again later');\n        break;\n      default:\n        toast.error(data.error || 'An error occurred');\n    }\n  } else if (error.code === 'ECONNABORTED') {\n    toast.error('Request timeout - please try again');\n  } else if (error.message === 'Network Error') {\n    toast.error('Network error - please check your connection');\n  } else {\n    toast.error('An unexpected error occurred');\n  }\n  return Promise.reject(error);\n});\n\n// API service methods\nexport const authAPI = {\n  login: credentials => api.post('/auth/login', credentials),\n  logout: () => api.post('/auth/logout'),\n  getProfile: () => api.get('/auth/me'),\n  updateProfile: data => api.put('/auth/me', data),\n  register: userData => api.post('/auth/register', userData)\n};\nexport const surveysAPI = {\n  getAll: params => api.get('/surveys', {\n    params\n  }),\n  getById: id => api.get(`/surveys/${id}`),\n  create: data => api.post('/surveys', data),\n  update: (id, data) => api.put(`/surveys/${id}`, data),\n  delete: id => api.delete(`/surveys/${id}`),\n  getResponses: (id, params) => api.get(`/surveys/${id}/responses`, {\n    params\n  })\n};\nexport const tokensAPI = {\n  getAll: params => api.get('/tokens', {\n    params\n  }),\n  create: data => api.post('/tokens', data),\n  pause: id => api.patch(`/tokens/${id}/pause`),\n  resume: id => api.patch(`/tokens/${id}/resume`),\n  delete: id => api.delete(`/tokens/${id}`)\n};\nexport const usersAPI = {\n  getAll: params => api.get('/users', {\n    params\n  }),\n  getById: id => api.get(`/users/${id}`),\n  create: data => api.post('/users', data),\n  update: (id, data) => api.put(`/users/${id}`, data),\n  delete: id => api.delete(`/users/${id}`)\n};\nexport const logsAPI = {\n  getAll: params => api.get('/logs', {\n    params\n  }),\n  getSummary: () => api.get('/logs/summary'),\n  getFilters: () => api.get('/logs/filters')\n};\nexport const widgetsAPI = {\n  getConfig: tokenId => api.get(`/widgets/${tokenId}/config`),\n  submitResponse: (tokenId, data) => api.post(`/widgets/${tokenId}/response`, data)\n};\nexport default api;","map":{"version":3,"names":["axios","toast","API_BASE_URL","process","env","REACT_APP_API_URL","api","create","baseURL","timeout","headers","interceptors","request","use","config","window","token","localStorage","getItem","Authorization","error","Promise","reject","response","newToken","setItem","status","data","removeItem","location","pathname","href","details","Array","isArray","forEach","param","msg","code","message","authAPI","login","credentials","post","logout","getProfile","get","updateProfile","put","register","userData","surveysAPI","getAll","params","getById","id","update","delete","getResponses","tokensAPI","pause","patch","resume","usersAPI","logsAPI","getSummary","getFilters","widgetsAPI","getConfig","tokenId","submitResponse"],"sources":["C:/Users/simko/Downloads/ZpRopim4/ZpetnaVazbaFinal/client/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\nimport { toast } from 'react-toastify';\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || '/api';\r\n\r\nconst api = axios.create({\r\n  baseURL: API_BASE_URL,\r\n  timeout: 10000,\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Request interceptor to add auth token\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    if (typeof window !== 'undefined') {\r\n      const token = localStorage.getItem('token');\r\n      if (token) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n      }\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor for error handling\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    // Check for new token in response headers (token refresh)\r\n    const newToken = response.headers['x-new-token'];\r\n    if (newToken && typeof window !== 'undefined') {\r\n      localStorage.setItem('token', newToken);\r\n    }\r\n    return response;\r\n  },\r\n  (error) => {\r\n    const { response } = error;\r\n    \r\n    if (response) {\r\n      const { status, data } = response;\r\n      \r\n      switch (status) {\r\n        case 401:\r\n          // Unauthorized - clear token and redirect to login\r\n          if (typeof window !== 'undefined') {\r\n            localStorage.removeItem('token');\r\n            if (window.location.pathname !== '/login') {\r\n              window.location.href = '/login';\r\n            }\r\n          }\r\n          break;\r\n        case 403:\r\n          toast.error('Access forbidden - insufficient permissions');\r\n          break;\r\n        case 404:\r\n          toast.error('Resource not found');\r\n          break;\r\n        case 422:\r\n          // Validation errors\r\n          if (data.details && Array.isArray(data.details)) {\r\n            data.details.forEach(error => {\r\n              toast.error(`${error.param}: ${error.msg}`);\r\n            });\r\n          } else {\r\n            toast.error(data.error || 'Validation failed');\r\n          }\r\n          break;\r\n        case 429:\r\n          toast.error('Too many requests - please slow down');\r\n          break;\r\n        case 500:\r\n          toast.error('Server error - please try again later');\r\n          break;\r\n        default:\r\n          toast.error(data.error || 'An error occurred');\r\n      }\r\n    } else if (error.code === 'ECONNABORTED') {\r\n      toast.error('Request timeout - please try again');\r\n    } else if (error.message === 'Network Error') {\r\n      toast.error('Network error - please check your connection');\r\n    } else {\r\n      toast.error('An unexpected error occurred');\r\n    }\r\n    \r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// API service methods\r\nexport const authAPI = {\r\n  login: (credentials) => api.post('/auth/login', credentials),\r\n  logout: () => api.post('/auth/logout'),\r\n  getProfile: () => api.get('/auth/me'),\r\n  updateProfile: (data) => api.put('/auth/me', data),\r\n  register: (userData) => api.post('/auth/register', userData),\r\n};\r\n\r\nexport const surveysAPI = {\r\n  getAll: (params) => api.get('/surveys', { params }),\r\n  getById: (id) => api.get(`/surveys/${id}`),\r\n  create: (data) => api.post('/surveys', data),\r\n  update: (id, data) => api.put(`/surveys/${id}`, data),\r\n  delete: (id) => api.delete(`/surveys/${id}`),\r\n  getResponses: (id, params) => api.get(`/surveys/${id}/responses`, { params }),\r\n};\r\n\r\nexport const tokensAPI = {\r\n  getAll: (params) => api.get('/tokens', { params }),\r\n  create: (data) => api.post('/tokens', data),\r\n  pause: (id) => api.patch(`/tokens/${id}/pause`),\r\n  resume: (id) => api.patch(`/tokens/${id}/resume`),\r\n  delete: (id) => api.delete(`/tokens/${id}`),\r\n};\r\n\r\nexport const usersAPI = {\r\n  getAll: (params) => api.get('/users', { params }),\r\n  getById: (id) => api.get(`/users/${id}`),\r\n  create: (data) => api.post('/users', data),\r\n  update: (id, data) => api.put(`/users/${id}`, data),\r\n  delete: (id) => api.delete(`/users/${id}`),\r\n};\r\n\r\nexport const logsAPI = {\r\n  getAll: (params) => api.get('/logs', { params }),\r\n  getSummary: () => api.get('/logs/summary'),\r\n  getFilters: () => api.get('/logs/filters'),\r\n};\r\n\r\nexport const widgetsAPI = {\r\n  getConfig: (tokenId) => api.get(`/widgets/${tokenId}/config`),\r\n  submitResponse: (tokenId, data) => api.post(`/widgets/${tokenId}/response`, data),\r\n};\r\n\r\nexport default api; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}